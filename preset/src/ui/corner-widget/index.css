:host {
  /* Base variables */
  --cw-size: 120px;
  --cw-spacing: 6px;
  --cw-radius: 8px;
  --cw-font: 12px;
  --cw-duration: 200ms;
  --cw-easing: cubic-bezier(0.4, 0, 0.2, 1);

  /* Size variables (based on base variables) */
  --cw-width: calc(var(--cw-size) * 1.2);
  --cw-button-size: calc(var(--cw-size) * 0.18);
  --cw-icon-size: calc(var(--cw-font) + 1px);
  --cw-drag-size: calc(var(--cw-font) - 1px);
  --cw-badge-size: calc(var(--cw-spacing) * 0.5);
  --cw-dock-width: calc(var(--cw-spacing) * 0.67);
  --cw-dock-height: calc(var(--cw-size) * 0.2);

  /* Position variables */
  --cw-right-hidden: calc(100% - var(--cw-spacing) - 52px);
  --cw-right-visible: calc(100% - var(--cw-width) - var(--cw-spacing));

  /* Spacing variables (based on base variables) */
  --cw-padding: var(--cw-spacing) var(--cw-spacing) var(--cw-spacing) 2px;
  --cw-gap: calc(var(--cw-spacing) * 0.67);
  --cw-list-padding: calc(var(--cw-spacing) * 0.33) calc(var(--cw-spacing) * 0.33) calc(var(--cw-spacing) * 0.5);
  --cw-list-gap: calc(var(--cw-spacing) * 0.33);
  --cw-item-padding: calc(var(--cw-spacing) * 0.67) calc(var(--cw-spacing) + 2px);
  --cw-item-gap: calc(var(--cw-spacing) * 0.5);

  /* Typography variables (based on base variables) */
  --cw-font-small: calc(var(--cw-font) - 1px);
  --cw-font-xs: calc(var(--cw-font) - 2px);

  /* Border radius variables (based on base variables) */
  --cw-radius-small: calc(var(--cw-radius) - 4px);
  --cw-radius-xs: calc(var(--cw-radius) - 6px);

  /* Position variables (based on base variables) */
  --cw-dock-offset: calc(-1 * var(--cw-spacing));
  --cw-dock-top: calc(var(--cw-size) * 0.14);

  /* Other variables */
  --cw-panel-max-height: calc(var(--cw-size) * 1.4);

  all: initial; /* Maximum isolation */
  contain: content;
  position: fixed;
  bottom: 10%;
  left: var(--cw-right-hidden);
  z-index: 2147483647;
  font-family:
    ui-sans-serif,
    system-ui,
    -apple-system,
    Segoe UI,
    Roboto,
    Helvetica,
    Arial,
    'Apple Color Emoji',
    'Segoe UI Emoji';
  transition:
    left var(--cw-duration) var(--cw-easing),
    opacity var(--cw-duration) var(--cw-easing);
  opacity: 0.4; /* Default opacity 40% */
}

:host(:hover) {
  left: var(--cw-right-visible);
  opacity: 1; /* 100% opacity on hover */
}

/* Keep expanded while dragging */
:host(.corner-widget--dragging) {
  left: var(--cw-right-visible);
  opacity: 1; /* 100% opacity while dragging */
}

/* Hidden state */
:host(.corner-widget--hidden) {
  display: none;
}

.corner-widget {
  width: var(--cw-width);
  box-sizing: border-box;
  pointer-events: auto;
}

.corner-widget__card {
  background: rgba(30, 32, 36, 0.95);
  color: #fff;
  border-radius: var(--cw-radius);
  overflow: hidden;
  backdrop-filter: blur(8px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.corner-widget__header {
  display: flex;
  align-items: center;
  gap: var(--cw-gap);
  padding: var(--cw-padding);
  cursor: pointer;
  user-select: none;
}

.corner-widget__drag {
  display: flex;
  align-items: center;
  justify-content: center;
  width: var(--cw-button-size);
  height: var(--cw-button-size);
  font-size: var(--cw-drag-size);
  color: #8b8b8b;
  opacity: 0.7;
  cursor: grab;
  user-select: none;
  letter-spacing: -2px;
  line-height: 1;
  transition: all var(--cw-duration) ease;
}

.corner-widget__drag:hover {
  opacity: 1;
  color: #a0a0a0;
  transform: scale(1.05);
}

/* Keep hover state while dragging */
:host(.corner-widget--dragging) .corner-widget__drag {
  opacity: 1;
  color: #a0a0a0;
  transform: scale(1.05);
}

.corner-widget__drag:active {
  cursor: grabbing;
  transform: scale(0.95);
}

.corner-widget__title {
  display: flex;
  flex: 1;
  overflow: hidden;
  align-items: center;
  white-space: nowrap;
  text-align: center;
  text-overflow: ellipsis;
  font-size: var(--cw-font);
  font-weight: 600;
}

.corner-widget__toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: var(--cw-button-size);
  height: var(--cw-button-size);
  border: none;
  border-radius: var(--cw-radius-small);
  font-size: var(--cw-icon-size);
  background: #2b2f36;
  color: #fff;
  cursor: pointer;
  transition: all var(--cw-duration) ease;
}

.corner-widget__toggle:hover {
  background: #39404a;
  transform: scale(1.05);
}

.corner-widget__toggle:active {
  transform: scale(0.95);
}

.corner-widget__panel {
  max-height: 0;
  overflow: hidden;
  transition: max-height var(--cw-duration) ease;
  opacity: 0;
  visibility: hidden;
}

:host(:hover) .corner-widget__panel--open,
:host(.corner-widget--dragging) .corner-widget__panel--open {
  max-height: var(--cw-panel-max-height);
  opacity: 1;
  visibility: visible;
}

.corner-widget__list {
  margin: 0;
  padding: var(--cw-list-padding);
  list-style: none;
  display: grid;
  gap: var(--cw-list-gap);
  overflow: auto;
}

.corner-widget__item {
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: var(--cw-item-gap);
  padding: var(--cw-item-padding);
  border-radius: var(--cw-radius-small);
  background: #1e2126;
  border: 1px solid rgba(255, 255, 255, 0.06);
  cursor: pointer;
  font-size: var(--cw-font-small);
  line-height: 1.3;
  transition: all calc(var(--cw-duration) - 80ms) ease;
  user-select: none;
}

.corner-widget__item:hover {
  background: #262b32;
  border-color: rgba(255, 255, 255, 0.12);
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.corner-widget__item:active {
  transform: translateY(0px);
}

.corner-widget__item-hint {
  opacity: 0.5;
  font-size: var(--cw-font-xs);
}

/* Submenu styles */
.corner-widget__submenu {
  display: none;
  position: absolute;
  left: 100%;
  top: 0;
  min-width: 120px;
  background: #1e2126;
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: var(--cw-radius-small);
  padding: calc(var(--cw-spacing) * 0.33);
  margin: 0;
  list-style: none;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  opacity: 0;
  visibility: hidden;
  transition:
    opacity var(--cw-duration) ease,
    visibility var(--cw-duration) ease;
}

.corner-widget__submenu--open {
  display: block;
  opacity: 1;
  visibility: visible;
}

/* Menu item styles in submenu */
.corner-widget__submenu .corner-widget__item {
  position: relative;
  margin-bottom: calc(var(--cw-spacing) * 0.33);
}

.corner-widget__submenu .corner-widget__item:last-child {
  margin-bottom: 0;
}

/* Parent item styles when it has a submenu */
.corner-widget__item[data-has-children='true'] {
  position: relative;
}

/* Submenu arrow animation */
.corner-widget__submenu--open + .corner-widget__item .corner-widget__item-arrow {
  transform: rotate(90deg);
}

/* Menu item content layout */
.corner-widget__item-content {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.corner-widget__item-left {
  display: flex;
  align-items: center;
  gap: var(--cw-item-gap);
}

.corner-widget__item-icon {
  font-size: var(--cw-icon-size);
}

.corner-widget__item-right {
  display: flex;
  align-items: center;
  gap: calc(var(--cw-spacing) * 0.67);
}

.corner-widget__item-arrow {
  font-size: var(--cw-font-xs);
  opacity: 0.6;
}

/* Small badge hint: ping once when collapsed to draw attention */
@keyframes ping {
  0% {
    transform: scale(1);
    opacity: 0.8;
  }
  80% {
    transform: scale(1.8);
    opacity: 0;
  }
  100% {
    transform: scale(1.8);
    opacity: 0;
  }
}

.corner-widget__badge {
  position: absolute;
  top: -3px;
  right: -3px;
  width: var(--cw-badge-size);
  height: var(--cw-badge-size);
  border-radius: 999px;
  background: #22c55e;
  animation: ping 1.4s cubic-bezier(0, 0, 0.2, 1) 1;
}

/* Main floating dock (makes the "default peek" more visible) */
.corner-widget__dock {
  position: absolute;
  inset: 0 auto auto var(--cw-dock-offset);
  width: var(--cw-dock-width);
  height: var(--cw-dock-height);
  border-radius: var(--cw-radius-xs) 0 0 var(--cw-radius-xs);
  background: #1e2126;
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-right: none;
  top: var(--cw-dock-top);
}
